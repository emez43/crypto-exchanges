<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="sytle.css">
    <title>Crypto Exchanges</title>

</head>

<body>

    <table id='table'>
        <tr>
            <th>Fiat</th>
            <th>Binance</th>
            <th>Houbi</th>
            <th>Coinbase</th>
            <th>Bithub</th>
            <th>Bisq</th>
        </tr>
        <tr>
            <td>BTC/USD</td>
            <td id="price_0.0"></td>
            <td id="price_0.1"></td>
            <td id="price_0.2"></td>
            <td id="price_0.3"></td>
            <td id="price_0.4"></td>
        </tr>
        <tr>
            <td>ETH/USD</td>
            <td id="price_1.0"></td>
            <td id="price_1.1"></td>
            <td id="price_1.2"></td>
            <td id="price_1.3"></td>
            <td id="price_1.4"></td>
        </tr>
        <tr>
            <td>BNB/USD</td>
            <td id="price_2.0"></td>
            <td id="price_2.1"></td>
            <td id="price_2.2"></td>
            <td id="price_2.3"></td>
            <td id="price_2.4"></td>

        </tr>
        <tr>
            <td>XRP/USD</td>
            <td id="price_3.0"></td>
            <td id="price_3.1"></td>
            <td id="price_3.2"></td>
            <td id="price_3.3"></td>
            <td id="price_3.4"></td>

        </tr>

        <tr>
            <td>ADA/USD</td>
            <td id="price_4.0"></td>
            <td id="price_4.1"></td>
        </tr>
        <tr>
            <td>DOGE/USD</td>
            <td id="price_5.0"></td>
            <td id="price_5.1"></td>
        </tr>
        <tr>
            <td>MATIC/USD</td>
            <td id="price_6.0"></td>
            <td id="price_6.1"></td>
        </tr>
        <tr>
            <td>SOL/USD</td>
            <td id="price_7.0"></td>
            <td id="price_7.1"></td>
        </tr>
         <tr>
            <td>DOT/USD</td>
            <td id="price_8.0"></td>
            <td id="price_8.1"></td>
        </tr>
        <tr>
            <td>LTC/USD</td>
            <td id="price_9.0"></td>
            <td id="price_9.1"></td>
        </tr>
        <tr>
            <td>TRX/USD</td>
            <td id="price_10.0"></td>
            <td id="price_10.1"></td>
        </tr>
        <tr>
            <td>SHIB/USD</td>
            <td id="price_11.0"></td>
            <td id="price_11.1"></td>
        </tr>
        <tr>
            <td>AVAX/USD</td>
            <td id="price_12.0"></td>
            <td id="price_12.1"></td>
        </tr>
        <tr>
            <td>DAI/USD</td>
            <td id="price_13.0"></td>
            <td id="price_13.1"></td>
        </tr>
        <tr>
            <td>WBTC/USD</td>
            <td id="price_14.0"></td>
            <td id="price_14.1"></td>
        </tr>
        <tr>
            <td>LINK/USD</td>
            <td id="price_15.0"></td>
            <td id="price_15.1"></td>
        </tr>
        <tr>
            <td>ATOM/USD</td>
            <td id="price_16.0"></td>
            <td id="price_16.1"></td>
        </tr>
        <tr>
            <td>XLM/USD</td>
            <td id="price_17.0"></td>
            <td id="price_17.1"></td>
        </tr>
        <tr>
            <td>UNI/USD</td>
            <td id="price_18.0"></td>
            <td id="price_18.1"></td>
        </tr>
        <tr>
            <td>XMR/USD</td>
            <td id="price_19.0"></td>
            <td id="price_19.1"></td>
        </tr>

    </table>
    <script type="module">
        import _ from 'https://cdn.skypack.dev/lodash';


        // API tömb

        const ex = [
            ['BINANCE', 'price',
                ["https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=ETHUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=BNBUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=XRPUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=ADAUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=DOGEUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=MATICUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=SOLUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=DOTUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=LTCUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=TRXUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=SHIBUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=AVAXUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=DAIUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=WBTCUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=LINKUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=ATOMUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=XLMUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=UNIUSDT",
                    "https://api.binance.com/api/v3/ticker/price?symbol=XMRUSDT",
                ]
            ],
            ['HUOBI', 'tick.close',
                ["https://api.huobi.pro/market/detail/merged?symbol=btcusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=ethusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=bnbusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=xrpusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=adausdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=dogeusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=maticusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=solusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=dotusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=ltcusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=trxusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=shibusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=avaxusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=daiusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=wbtcusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=linkusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=atomusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=xlmusdt",
                    "https://api.huobi.pro/market/detail/merged?symbol=uniusdt",
                   "https://api.huobi.pro/market/detail/merged?symbol=xmrusdt",
                ]
            ],
            ['coinbase', "data.amount",
                ['https://api.coinbase.com/v2/prices/BTC-USD/spot',
                    'https://api.coinbase.com/v2/prices/ETH-USD/spot',
                    'https://api.coinbase.com/v2/prices/BNB-USD/spot',
                    'https://api.coinbase.com/v2/prices/XRP-USD/spot']
            ],
            ['Bithub', "data.closing_price",
                ['https://api.bithumb.com/public/ticker/BTC',
                    'https://api.bithumb.com/public/ticker/ETH',
                    'https://api.bithumb.com/public/ticker/BNB',
                    'https://api.bithumb.com/public/ticker/XRP']
            ],
             ['Bisq', "last",
                ['https://bisq.markets/api/ticker?market=BTC_USD',
                    'https://bisq.markets/api/ticker?market=ETH_USD',
                    'https://bisq.markets/api/ticker?market=BTC_USD',
                    'https://bisq.markets/api/ticker?market=XMR_USD']
            ]
        ]

        const table = document.getElementById('table')

        exch()
        setInterval(exch, 1000)

        /*
                for (let i = 0; i < ex.length; i++) {
                    //console.log(ex[i][0])
                    for (let j = 0; j < ex[i][2].length; j++) {
                        //console.log(i,j)
                        // console.log(ex[i][1])
                        //console.log(ex[i][2][j])
                    }
                }*/

        // API Fetch és ciklus
        function exch() {
            for (let i = 0; i < ex.length; i++) {
                for (let j = 0; j < ex[i][2].length; j++) {

                    fetch(ex[i][2][j])
                        .then(response => {
                            return response.json()
                            // console.log(response)

                        }
                        )
                        .then(data => {
                            //console.log(data)
                            const price = Number(_.get(data, ex[i][1])).toFixed(4)
                            //console.log(price)
                            const priceContainer = document.getElementById("price_" + [j] + '.' + [i]);
                            priceContainer.innerText = `${price}`;
                        })
                        //.catch(error => console.log(error))
                }
            }
        }

        /*
        //async/await
        function exch() {
            for (let i = 0; i < ex.length; i++) {
                for (let j = 0; j < ex[i][2].length; j++) {
                    
                    getData()

                    async function getData() {
            try {
                const response = await fetch(ex[i][2][j])
                const data = await response.json()
                console.log(data)
                const price = Number(_.get(data, ex[i][1])).toFixed(4)
                //console.log(price)
                const priceContainer = document.getElementById("price_" + j + '.' + i);
                priceContainer.innerText = `${price}`;
        
            } catch (error) {
                console.error(error);
            }
        }
    }}}

    fetch('https://bisq.markets/api/ticker?market=BTC_USD')
  .then(response => response.json())
  .then(data => {
    const btcUsdPrice = data.last;
    console.log(`A jelenlegi Bitcoin-USD árfolyam: ${btcUsdPrice}`);
  })
  .catch(error => {
    console.error('Hiba történt a lekérdezés során:', error);
  });*/


    </script>




</body>

</html>